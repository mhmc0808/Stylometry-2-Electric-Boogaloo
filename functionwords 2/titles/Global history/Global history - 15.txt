European empires were addicted to opium smoking. Then their own agents launched a moral crusade to prohibit it